---
slug: classification
---

|언어|라이브러리|버전|컴포넌트/모듈|클래스|용도|
|---|---|---|---|---|---|
|Python|Scikit-learn||sklearn|datasets|MNIST 데이터셋 사용|
|||||linear_model|SGDClassifier(확률적 경사하강 선형 분류) 모델 사용|
|||||model_selection|k-폴드 교차 검증 사용|
||Matplotlib||matplotlib|pyplot|데이터 시각화|

1. 데이터셋 불러오기
   - https://www.openml.org/search?type=data&sort=runs&status=active의 데이터를 불러옵니다.
```python
from sklearn.datasets import fetch_openml

mnist = fetch_openml('mnist_784', as_frame=False)
```

2. 데이터 시각화
```python
import matplotlib.pyplot as plt

def plot_digit(image_data):
  image = image_data.reshape(28, 28) # tensorflow의 mnist 데이터셋은 처음부터 28x28 모양
  plt.imshow(image, cmap="binary")
  plt.axis("off") # 축 비활성화

some_digit = X[0]
plot_digit(some_digit)
plt.show()
```

3. 훈련셋, 테스트셋 분리
```python
X_train, X_test, y_train, y_test = X[:60000], X[60000:], y[:60000], y[60000:]
```

5. 5-이진 분류기 만들기
```python
from sklearn.linear_model import SGDClassifier

sgd_clf = SGDClassifier(random_state=42) # 난수 시드가 42
sgd_clf.fit(X_train, y_train_5) # 학습
```

6. 5-이진 분류기 테스트
```
sgd_clf.predict([X[35]])
```

7. 3-폴드 교차 검증
```python
from sklearn.model_selection import cross_val_score # k-fold를 포함한 교차 검증

cross_val_score(sgd_clf, X_train, y_train_5, cv=3, scoring="accuracy") # 폴드가 3개 = 학습셋을 3개로 나누고
```

confusion metrics
1. 맞는데 맞다고 한것: TP
2. 틀렸는데 틀렸다고 한것: TN
3. 맞는데 틀렸다고 한것: FN
4. 틀렸는데 맞았다고 한것: FP

F1 Score: 위를 바탕으로 계산된 모델의 점수, 정밀도와 재현율의 조화평균


쓰레스홀드
맞다고 하는건 확실히 맞아야 함 => FN은 많아도 되고 FP은 적어야함 => 
