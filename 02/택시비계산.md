
## 사용 언어
|언어|버전|
|---|---|
|Python|3.12.4|

## 사용 라이브러리
|언어|라이브러리|버전|모듈/클래스|용도|
|---|---|---|---|---|
|Python|scikit-learn|1.6.1|sklearn.linear_model/LinearRegression|선형 회귀 모델 사용|
||||sklearn.neighbors/KNeighborsRegressor|k-최근접 이웃 회귀 모델 사용|
||pandas|2.2.3|pandas|데이터 불러오기|
||matplotlib|3.10.1|matplotlib.pyplot|데이터 시각화|


## 디렉토리 구조
ml   
ㄴvenv/   
ㄴdata.csv   
ㄴuntitled.py   

## 코드
```csv
distance,price
0.2,3000
1,14000
2,32000
10,150000
5,130000
```

5km의 값은 이상치로 가정

```python
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.linear_model import LinearRegression

lifesat = pd.read_csv('data.csv')
X = lifesat[['distance']].values
Y = lifesat[['price']].values

lifesat.plot(kind='scatter', grid=True, x='distance', y='price')
plt.axis([0, 9, 0, 150000])
plt.show()

model = LinearRegression()
model.fit(X, Y)

X_new = [[5.2]]
print(model.predict(X_new))
```

선형 회귀 모델을 k-최근접 이웃 회귀 모델로 변경:
```python
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.neighbors import KNeighborsRegressor

lifesat = pd.read_csv('data.csv')
X = lifesat[['distance']].values
Y = lifesat[['price']].values

lifesat.plot(kind='scatter', grid=True, x='distance', y='price')
plt.axis([0, 9, 0, 150000])
plt.show()

model = KNeighborsRegressor(n_neighbors=3)
model.fit(X, Y)

X_new = [[5.2]]
print(model.predict(X_new))
```

두 모델을 비교:
```python
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.neighbors import KNeighborsRegressor

lifesat = pd.read_csv('data.csv')
X = lifesat[['distance']].values
Y = lifesat[['price']].values

model1 = LinearRegression()
model1.fit(X, Y)

model2 = KNeighborsRegressor(n_neighbors=3)
model2.fit(X, Y)

X_new = [[5.2]]
print(f'Linear: {model1.predict(X_new)}')
print(f'KNeighbor: {model2.predict(X_new)}')
```

결과:
```
Linear: [[91013.54401806]]
KNeighbor: [[58666.66666667]]
```

csv 수정:
```csv
distance,price
0.2,3000
1,14000
2,32000
10,150000
5,70000
```

결과:
```
Linear: [[77018.05869074]]
KNeighbor: [[38666.66666667]]
```

